montageDefine("51f539f","observers",{dependencies:["collections/shim","collections/listen/property-changes","collections/listen/array-changes","collections/sorted-array","collections/sorted-set","collections/map","collections/set","collections/heap","./scope","./operators","./parse","./compile-observer","./merge"],factory:function(e,t){function n(e){return function(t){return t(e)||Function.noop}}function i(e,t){return e(t.value)||Function.noop}function r(e,t){return e(t.parameters)||Function.noop}function a(e){return function(t,n){return t(n.document.getElementById(e))||Function.noop}}function s(e,t){return function(n,i){var r=i.components,a=r.getObjectByLabel||r.getComponentByLabel,s=a.call(r,e);return t.component=s,n(s)||Function.noop}}function o(e,t,n,i){function r(e,t,i){a(),a=n(e,t,i)||Function.noop}if(null==e)return n();var a=Function.noop;return yt.addOwnPropertyChangeListener(e,t,r,i.beforeChange),r(e[t],t,e),bt(function(){a(),yt.removeOwnPropertyChangeListener(e,t,r,i.beforeChange)})}function l(e,t){return function(n,i){return t(_t(function(t){return"string"!=typeof t&&"number"!=typeof t?n():e(_t(function(e){return null==e?n():e.observeProperty?e.observeProperty(t,n,i):St(e,t,n,i)}),i)}),i)}}function c(e,t,n,i){function r(e,i,r){s(t,i)&&(a(),a=n(e,t,r)||Function.noop)}var a=Function.noop,s=e.contentEquals||Object.equals;return r(e.get(t),t,e),e.addMapChangeListener(r,i.beforeChange),bt(function(){a(),e.removeMapChangeListener(r)})}function u(e,t){return function(n,i){return e(_t(function(e){return e?t(_t(function(t){return null==t?n():e.observeGet?e.observeGet(t,n,i):Et(e,t,n,i)}),i):n()}),i)}}function h(e,t){return function(n,i){return n=gt(n),t(_t(function(t){return e(_t(function(e){return e?K(e,function(){return n((e.has||e.contains).call(e,t))},i):n()}),i)}),i)}}function d(e){return function(t,n){for(var i=Array(e.length),r=0;e.length>r;r++)i[r]=void 0;var a=e.map(function(e,t){return e(function(e){i.set(t,e)},n)}),s=t(i)||Function.noop;return bt(function(){s(),vt(a)})}}function p(e){return function(t,n){var i={},r={};for(var a in e)(function(e,t){i[e]=t(function(t){r[e]=t},n)})(a,e[a]);var s=t(r)||Function.noop;return function(){s();for(var e in i)i[e]()}}}function m(){return d(Array.prototype.slice.call(arguments))}function f(e){return function(){var t=d(Array.prototype.slice.call(arguments)),n=et(t);return function(t,i){return n(_t(function(n){return n.every(Mt.defined)?t(e.apply(void 0,n)):t()}),i)}}}function g(e){var t=e.slice(0,1).toUpperCase()+e.slice(1),n="make"+t+"Observer",i="observe"+t;return function(){var t=arguments[0],r=Array.prototype.slice.call(arguments,1),a=r.map(function(e){return function(t,n){return e(_t(t),n)}}),s=d(r),o=et(s);return function(r,s){return t(_t(function(t){return t?t[n]?t[n].apply(t,a)(r,s):t[i]?t[i](r,s):o(_t(function(n){return n.every(Mt.defined)?"function"==typeof t[e]?r(t[e].apply(t,n)):r():r()}),s):r()}),s)}}}function v(e){return function(t,n){return e(_t(function(e){return t(!e)}),n)}}function _(e,t){return function(n,i){return e(_t(function(e){return e?t(n,i):n(e)}),i)}}function b(e,t){return function(n,i){return e(_t(function(e){return e?n(e):t(n,i)}),i)}}function y(e,t,n){return function(i,r){return e(_t(function(e){return null==e?i():e?t(i,r):n(i,r)}),r)}}function C(e){return function(t,n){return e(_t(function(e){return t(null!=e)}),n)}}function L(e,t){return function(n,i){return e(_t(function(e){return null==e?t(n,i):n(e)}),i)}}function w(e,t){return function(n,i){return e(_t(function(e){function r(t){for(;e.length>t;t++)o[t].index=t}function a(e,n,a){o.swap(a,n.length,e.map(function(e,t){return{index:a+t}})),r(a+e.length);var c,u=[];vt(l.swap(a,n.length,e.map(function(e,n){var r=o[a+n];return t(_t(function(e){c?s.set(r.index,e):u[n]=e}),i.nest(e))}))),c=!0,s.swap(a,n.length,u)}if(!e)return n();var s=[],o=[],l=[],c=K(e,a,i),u=n(s,e)||Function.noop;return bt(function(){u(),vt(l),c()})}),i)}}function x(e,t){var n=w(e,t);return function(e,t){return n(_t(function(n,i){function r(e){for(;n.length>e;e++)l[e+1]=l[e]+!!n[e]}function a(e,t,n){var a=i.slice(n,n+e.length),o=t.map(Boolean).sum(),c=a.filter(function(t,n){return e[n]}),u=l[n],h=s.slice(u,u+o);(h.length!==c.length||h.some(function(e,t){return e!==c[t]}))&&s.swap(u,o,c),r(u)}if(!i)return e();var s=[],o=[],l=[0],c=K(n,a,t),u=e(s)||Function.noop;return bt(function(){u(),vt(o),c()})}),t)}}function M(e,t){var n=z(t),i=w(e,n),r=function(e,t){return i(_t(function(n){function i(e,t){a.addEach(e),a.deleteEach(t)}if(!n)return e();var r=[],a=Ct(r,S,E),s=K(n,i,t),o=e(r)||Function.noop;return function(){o(),s()}}),t)};return zt(r,st)}function S(e,t){return Object.equals(e[1],t[1])}function E(e,t){return Object.compare(e[1],t[1])}function z(e){return function(t,n){return e(_t(function(e){return t([n.value,e])||Function.noop}),n)}}function O(e,t){var n=z(t),i=w(e,n),r=j(i,lt),a=w(r,Z(lt));return function(e,t){function n(e,t){return e=o.get(e),t=o.get(t),Object.compare(e,t)}function i(e,t){return e=o.get(e),t=o.get(t),Object.equals(e,t)}function r(e,t){t.forEach(function(e){l["delete"](e[0]),o["delete"](e[0])}),e.forEach(function(e){o.set(e[0],e[1]),l.add(e[0])})}function s(e){return l.clear(),K(e,r,t)}var o=new wt,l=new Lt(null,i,n),c=e(l)||Function.noop,u=a(s,t);return function(){c(),u()}}}function T(e){return function(t,n){return e(_t(function(e){function i(e,t,n){var i=r.length-n-t.length;r.swap(i,t.length,e.reversed())}if(!e)return t();var r=[],a=K(e,i,n),s=t(r);return bt(function(){s(),a()})}),n)}}function P(e){return function(t,n){return e(_t(function(e){function i(t){for(var n=t;e.length>n;n++)l[n].index=n,o[n+1]=e[n]?o[n]+e[n].length:o[n]}function r(e,t,r){var c=o[r],u=o[r+t.length],h=u-c;a.swap(c,h,[]),l.swap(r,t.length,e.map(function(){return{index:null}})),i(r),vt(s.swap(r,t.length,e.map(function(e,t){function s(e,t,n){i(c.index);var r=o[c.index]+n,s=o[c.index]+n+t.length,l=s-r;a.swap(r,l,e)}var c=l[r+t];return K(e,s,n)})))}if(!e)return t();var a=[],s=[],o=[0],l=[],c=K(e,r,n),u=t(a)||Function.noop;return bt(function(){u(),vt(s),c()})}),n)}}function D(){return Tt(d(Array.prototype.slice.call(arguments)))}function k(e,t){var n=Ot(e,t),i=l(n,Pt);return ht(i,Boolean)}function A(e,t){var n=ht(t,Mt.not),i=Ot(e,n),r=l(i,Pt);return ht(r,Mt.not)}function j(e,t){var n=B(e,t);return At(n)}function B(e,t){var n=z(t),i=w(e,n);return function(e,t){return i(_t(function(n,i){function r(e,t){t.forEach(function(e){var t=a.get(e[1]);1===t.length?a["delete"](e[1]):t["delete"](e[0])}),e.forEach(function(e){var t,n=!a.has(e[1]);t=n?i.constructClone():a.get(e[1]),t.add(e[0]),n&&a.set(e[1],t)})}if(!n)return e();var a=wt(),s=K(n,r,t),o=e(a)||Function.noop;return function(){s(),o()}}),t)}}function I(e,t,n){function i(e,t){return Object.compare(e[1],t[1])*n}var r=z(t),a=w(e,r);return function(e,t){return a(_t(function(n){function r(e,t){s.addEach(e),s.deleteEach(t)}function a(t,n){return 0===n?t?e(t[0]):e():void 0}if(!n)return e();var s=new xt(null,S,i),o=K(n,r,t),l=nt(s,a,t);return function(){o(),l()}}),t)}}function R(e,t){return I(e,t,1)}function F(e,t){return I(e,t,-1)}function N(e){return function(t){return function(n,i){return n=gt(n),t(_t(function(t){if(!t)return n();var r=e(t,n);return K(t,function(e,t,i){return n(r(e,t,i))},i)}),i)}}}function q(e){return"number"==typeof e&&!isNaN(e)}function V(e,t,n){return function(i,r){return e(_t(function(e){return e?n(_t(function(n){return null==n?i():t(_t(function(t){function a(i,r,a){var o=i.length-r.length;t>a&&0>o&&n>o?(s.swap(s.length,0,e.slice(t+n+o,t+n)),s.splice(0,-o)):t>a&&o>0&&n>o?(s.swap(0,0,e.slice(t,t+o)),s.splice(s.length-o,o)):a>=t&&0>o&&t+n>a?(s.swap(s.length,0,e.slice(t+n+o,t+n)),s.splice(a-t,-o)):a>=t&&o>0&&t+n>a?(s.swap(a-t,0,e.slice(a,a+o)),s.splice(s.length-o,o)):t+n>a&&s.swap(0,s.length,e.slice(t,t+n))}if(null==t)return i();var s=[],o=K(e,a,r),l=i(s)||Function.noop;return bt(function(){l(),o()})}),r)}),r):i()}),r)}}function U(e){return function(t,n){return e(_t(function(e){function i(e){for(;a.length>e;e++)a[e].set(0,e)}function r(e,t,n){a.swap(n,t.length,e.map(function(e,t){return[n+t,e]})),i(n+e.length)}if(!e)return t();var a=[],s=K(e,r,n),o=t(a)||Function.noop;return function(){o(),s()}}),n)}}function W(e){return function(t,n){var i=[],r=t(i)||Function.noop,a=e(function(e){if(e>>>=0,null==e)i.clear();else if(e>i.length){for(var t=[],n=i.length;e>n;n++)t.push(n);i.swap(i.length,0,t)}else i.length>e&&i.splice(e,i.length)},n);return function(){r(),a()}}}function H(e,t){return function(n,i){return t(function(t){var r=RegExp("^"+RegExp.escape(t));return e(function(e){return n(r.test(e))||Function.noop},i)},i)}}function Y(e,t){return function(n,i){return t(function(t){var r=RegExp(RegExp.escape(t)+"$");return e(function(e){return n(r.test(e))||Function.noop},i)},i)}}function G(e,t){return function(n,i){return t(function(t){var r=RegExp(RegExp.escape(t));return e(function(e){return n(r.test(e))||Function.noop},i)},i)}}function X(e,t){return t=t||Dt,function(n,i){return e(_t(function(e){return e?t(_t(function(t){function r(){a=n(e.join(t))||Function.noop}if("string"!=typeof t)return n()||Function.noop;var a=Function.noop,s=K(e,r,i);return function(){s(),a()}}),i):n()||Function.noop}),i)}}function K(e,t,n){function i(e,n,i){r(),r=t(e,n,i)||Function.noop}if(e){var r=Function.noop;if(e.toArray&&e.addRangeChangeListener){i(e.toArray(),[],0);var a=e.addRangeChangeListener(i,n.beforeChange);return bt(function(){r(),a()})}}}function Z(e){return function(t,n){return e(_t(function(e){return kt(e,t,n)}),n)}}function J(e,t,n){function i(n,i,o){if(r+=n.length-i.length,!(r>o+i.length&&r>o+n.length)){var l=0>r?null:e.get(r);a(),a=t(l)||Function.noop,s=l}}var r=-1,a=Function.noop,s=null,o=K(e,i,n);return function(){a(),o()}}function $(e){return function(t,n){return e(_t(gt(function(e){return Q(e,t,n)})),n)}}function Q(e,t,n){function i(n,i){return r+=n.length-i.length,1===r?t(e.only()):t()}var r=0;return K(e,i,n)}function et(e){return function(t,n){return e(_t(function(e){return e&&e.addRangeChangeListener?K(e,function(){return t(e)},n):t(e)}),n)}}function tt(e){return function(t,n){return e(_t(function(e){return e&&e.addMapChangeListener?nt(e,function(){return t(e)},n):t(e)}),n)}}function nt(e,t,n){function i(e,n,i){var a=r.get(n)||Function.noop;r["delete"](n),a(),a=t(e,n,i)||Function.noop,void 0===e?a():r.set(n,a)}if(e.addMapChangeListener){var r=new wt;e.forEach(i);var a=e.addMapChangeListener(i,n.beforeChange);return bt(function(){r.forEach(function(e){e()}),a()})}}function it(e){return function(t,n){return e(_t(function(e){return e?rt(e,t,n):t()}),n)}}function rt(e,t,n){function i(e,t){var n,i;a.has(t)?null==e?(n=a.get(t),a["delete"](t),i=r.indexOf(n),r.splice(i,1)):(n=a.get(t),n.set(1,e)):(n=[t,e],a.set(t,n),r.push(n))}var r=[],a=wt(),s=t(r)||Function.noop,o=nt(e,i,n)||Function.noop;return bt(function(){s(),o()})}function at(e){var t=At(e);return zt(t,st)}function st(e,t){return t.value?e(t.value[0])||Function.noop:e()}function ot(e){var t=At(e);return zt(t,lt)}function lt(e,t){return t.value?e(t.value[1])||Function.noop:e()}function ct(e){return function(t,n){var i=new wt,r=t(i)||Function.noop,a=e(_t(function(e){function t(e,t){void 0===e?i["delete"](t):i.set(t,e)}if(i.clear(),e&&"object"==typeof e){if(e.addRangeChangeListener)return jt(_t(function(e){function t(e,t){t.forEach(function(e){i["delete"](e[0])}),e.forEach(function(e){i.set(e[0],e[1])})}return K(e,t,n)}),n.nest(e));if(e.addMapChangeListener)return nt(e,t,n);var r=Object.keys(e).map(function(t){return St(e,t,_t(function(e){void 0===e?i["delete"](t):i.set(t,e)}),n)});return function(){vt(r)}}}),n);return function(){r(),a()}}}function ut(e){return function(t,n){return e(t,n.parent||n.nest())}}function ht(e,t,n){return function(i,r){return i=gt(i),e(_t(function(e){return i(t.call(n,e))}),r)}}function dt(e,t,n){return function(i,r){return i=gt(i),e(_t(function(e){return e&&e.every(Mt.defined)?i(t.apply(n,e)):void 0}),r)}}function pt(t,n){var i=e("./parse"),r=e("./compile-observer");return function(e,a){return e=gt(e),n(_t(function(n){if(null==n)return e();var s,o;try{s=i(n),o=r(s)}catch(l){return e()}return t(_t(function(t){return o(e,a.nest(t))}),a)}),a)}}function mt(e,t){return function(n,i){return e(_t(function(e){return t(_t(function(e){return n(e)}),i.nest(e))}),i)}}function ft(e){return function(){var t=e.apply(this,arguments);return function(e,n){var i=[],r=t(_t(function(e){function t(e,t,n){i.swap(n,t.length,e)}if(e){Bt(i,e);var r=e.addRangeChangeListener(t,n.beforeChange);return bt(r)}i.clear()}),n),a=e(i)||Function.noop;return bt(function(){r(),a()})}}}function gt(e){var t;return function(n){if(n!==t){var i=e.apply(this,arguments);return t=n,i}}}function vt(e){e.forEach(function(e){e&&e()})}function _t(e){var t=Function.noop;return function(){return t(),t=e.apply(this,arguments)||Function.noop,function(){t()}}}function bt(e){var t;return function(){return t?Function.noop:(t=!0,e.apply(this,arguments))}}e("collections/shim");var yt=e("collections/listen/property-changes");e("collections/listen/array-changes");var Ct=e("collections/sorted-array"),Lt=e("collections/sorted-set"),wt=e("collections/map");e("collections/set");var xt=e("collections/heap");e("./scope");var Mt=e("./operators");t.makeLiteralObserver=n,t.observeValue=i,t.observeParameters=r,t.makeElementObserver=a,t.makeComponentObserver=s,t.observeProperty=o;var St=o;t.makePropertyObserver=l,t.observeKey=c,t.observeGet=c;var Et=c;t.makeGetObserver=u,t.makeHasObserver=h,t.makeObserversObserver=d,t.makeRecordObserver=p,t.makeObjectObserver=p,t.makeTupleObserver=m,t.makeArrayObserver=m,t.makeOperatorObserverMaker=f,t.makeMethodObserverMaker=g,t.makeNotObserver=v,t.makeAndObserver=_,t.makeOrObserver=b,t.makeConditionalObserver=y,t.makeDefinedObserver=C,t.makeDefaultObserver=L;var zt=t.makeMapBlockObserver=ft(w),Ot=t.makeFilterBlockObserver=ft(x);t.makeSortedBlockObserver=M,t.makeSortedSetBlockObserver=O,t.makeReversedObserver=ft(T);var Tt=t.makeFlattenObserver=ft(P);t.makeConcatObserver=D,t.makeSomeBlockObserver=k,t.makeEveryBlockObserver=A,t.makeGroupBlockObserver=j,t.makeGroupMapBlockObserver=B,t.makeMaxBlockObserver=R,t.makeMinBlockObserver=F;var Pt=n("length");t.makeSumObserver=N(function(){var e=0;return function(t,n){return t=t.filter(q),n=n.filter(q),e+=t.sum()-n.sum()}}),t.makeAverageObserver=N(function(){var e=0,t=0;return function(n,i){return n=n.filter(q),i=i.filter(q),e+=n.sum()-i.sum(),t+=n.length-i.length,e/t}}),t.makeViewObserver=ft(V),t.makeEnumerateObserver=ft(U),t.makeEnumerationObserver=t.makeEnumerateObserver,t.makeRangeObserver=W,t.makeStartsWithObserver=H,t.makeEndsWithObserver=Y,t.makeContainsObserver=G,t.makeJoinObserver=X;var Dt=n("");t.observeRangeChange=K,t.makeLastObserver=Z,t.observeLast=J;var kt=J;t.makeOnlyObserver=$,t.observeOnly=Q,t.makeRangeContentObserver=et,t.makeMapContentObserver=tt,t.observeMapChange=nt;var At=t.makeEntriesObserver=ft(it);t.observeEntries=rt,t.makeKeysObserver=at,t.observeEntryKey=st,t.makeValuesObserver=ot,t.observeEntryValue=lt,t.makeToMapObserver=ct;var jt=zt(j(i,st),Z(lt));t.makeParentObserver=ut,t.makeConverterObserver=ht,t.makeComputerObserver=dt,t.makePathObserver=pt,t.makeExpressionObserver=pt,t.makeWithObserver=mt,t.makeToArrayObserver=ft(Function.identity),t.makeAsArrayObserver=t.makeToArrayObserver;var Bt=e("./merge").merge;t.makeUniq=gt,t.cancelEach=vt,t.autoCancelPrevious=_t,t.once=bt}});